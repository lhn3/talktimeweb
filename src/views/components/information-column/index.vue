<template>
  <div
    :class="$style['information-column']"
    :style="{ width: user.userInfo.isShowMoreInfo ? '15vw' : 0, minWidth: user.userInfo.isShowMoreInfo ? '180px' : 0 }"
    v-loading="state.loading"
  >
    <user-info-card :user-info="state.userInfo" :card-type="2" @refresh-user-info="refreshUserInfo" />
  </div>
</template>
<script setup>
  import { watch, defineProps, reactive, ref } from 'vue'
  import { useUserStore } from '@/stores'
  import UserInfoCard from '@/components/user-info-card/user-info-card.vue'
  import { friendList } from '@/stores/test'

  const user = useUserStore()
  const props = defineProps({
    // 正在聊天的id
    chattingId: {
      type: Number,
      required: true
    }
  })

  const state = reactive({
    loading: false,
    userInfo: {}
  })

  watch(
    () => user.userInfo.isShowMoreInfo,
    value => {
      if (!value) {
        state.userInfo = {}
        return
      }
      //重新请求数据
      state.loading = true
      setTimeout(() => {
        state.userInfo = friendList[0].list[0]
        state.loading = false
      }, 1000)
    }
  )

  const refreshUserInfo = value => {
    state.userInfo = value
  }
</script>
<style module lang="scss">
  .information-column {
    height: 100%;
    transition: all 0.5s;
    overflow-y: scroll;
    overflow-x: scroll;
    background-image: linear-gradient(to bottom right, var(--bg-4), var(--bg-2));
    :global {
    }
  }
</style>
